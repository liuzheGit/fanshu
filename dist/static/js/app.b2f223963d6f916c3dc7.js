webpackJsonp([1],{"5/Ai":function(e,t){},"8sJK":function(e,t){},CCvi:function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("/5sW"),n=r("Dd8w"),i=r.n(n),o=r("NYxO"),a={name:"Header",data:function(){return{active:"/"}},created:function(){var e=this;this.active=this.$route.path,this.$router.afterEach(function(t,r){e.active=t.path})},computed:Object(o.d)(["user"]),methods:i()({handleSelect:function(e,t){console.log(e,t)}},Object(o.b)(["exit"]),{heandleExit:function(){this.exit(),this.$api.SDK.User.logOut(),this.$router.push({path:"/"}),this.$message.success("成功退出!")}})},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("el-menu",{staticClass:"el-menu",attrs:{router:!0,"default-active":e.active,mode:"horizontal"},on:{select:e.handleSelect}},[r("el-menu-item",{staticClass:"logo",attrs:{index:"/"}},[e._v("番薯")]),e._v(" "),r("el-menu-item",{attrs:{index:"/article?type=all"}},[r("i",{staticClass:"fa fa-flag",attrs:{"aria-hidden":"true"}}),e._v(" 探索")]),e._v(" "),e.user?[r("el-menu-item",{staticClass:"right myLi",attrs:{index:"6"},on:{click:e.heandleExit}},[r("i",{staticClass:"fa fa-sign-out",attrs:{"aria-hidden":"true"}}),e._v(" 注销")]),e._v(" "),r("el-submenu",{staticClass:"right myLi",attrs:{index:"5"}},[r("span",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.user.getUsername())+" ")]),e._v(" "),r("el-menu-item",{attrs:{index:"me",route:{name:"User",params:{id:e.user.id}}}},[e._v("我的主页")]),e._v(" "),r("el-menu-item",{attrs:{index:"/friend"}},[e._v("朋友圈")]),e._v(" "),r("el-menu-item",{attrs:{index:"/article?type=me"}},[e._v("我的文章")]),e._v(" "),r("el-menu-item",{attrs:{index:"/ArticleCreate"}},[e._v("发布文章")]),e._v(" "),r("el-menu-item",{attrs:{index:"/followee"}},[e._v("我的关注")]),e._v(" "),r("el-menu-item",{attrs:{index:"/follower"}},[e._v("我的粉丝")]),e._v(" "),r("el-menu-item",{attrs:{index:"/message"}},[e._v("消息")])],1)]:[r("el-menu-item",{staticClass:"right myLi",attrs:{index:"/signUp"}},[r("i",{staticClass:"fa fa-user-o",attrs:{"aria-hidden":"true"}}),e._v(" 注册")]),e._v(" "),r("el-menu-item",{staticClass:"right myLi",attrs:{index:"/signIn"}},[r("i",{staticClass:"fa fa-key",attrs:{"aria-hidden":"true"}}),e._v(" 登陆")])]],2)],1)},staticRenderFns:[]};var c={name:"App",components:{Header:r("VU/8")(a,l,!1,function(e){r("dpXV")},"data-v-8a299c7a",null).exports},mounted:function(){this.$Progress.finish()},created:function(){var e=this;this.$Progress.start(),this.$router.beforeEach(function(t,r,s){if(void 0!==t.meta.progress){var n=t.meta.progress;e.$Progress.parseMeta(n)}e.$Progress.start(),s()})}},u={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("Header"),this._v(" "),t("router-view"),this._v(" "),t("vue-progress-bar")],1)},staticRenderFns:[]};var d=r("VU/8")(c,u,!1,function(e){r("oNCY")},null,null).exports,m=r("/ocq"),f={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"hello container"},[t("h1",[this._v(this._s(this.msg))])])},staticRenderFns:[]};var g=r("VU/8")({name:"HelloWorld",data:function(){return{msg:"Welcome my friend!"}},mounted:function(){this.$Progress.finish()}},f,!1,function(e){r("CCvi")},"data-v-4e7bbe08",null).exports,h={name:"signUp",data:function(){var e=this;return{labelPosition:"top",user:{name:"",email:"",pwd:"",cpwd:""},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:7,message:"长度在 3 到 7 个字符之间",trigger:"blur"}],email:[{required:!0,message:"请填入邮箱",trigger:"blur"},{type:"email",message:"必须是合法的邮箱格式",trigger:"blur"}],pwd:[{required:!0,message:"必须填写",trigger:"blur"},{validator:function(t,r,s){""===r?s(new Error("请输入密码")):(""!==e.user.cpwd&&e.$refs.form.validateField("cpwd"),s())},trigger:"blur"}],cpwd:[{required:!0,message:"必须填写",trigger:"blur"},{validator:function(t,r,s){""===r?s(new Error("请再次输入密码")):r!==e.user.pwd?s(new Error("两次输入密码不一致!")):s()},trigger:"blur"}]}}},mounted:function(){this.$Progress.finish()},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),t.$message.error("错了哦，您填写的信息有错误，请按照提示修改。"),!1;var r=new t.$api.SDK.User;r.setUsername(t.user.name),r.setPassword(t.user.pwd),r.setEmail(t.user.email),r.signUp().then(function(e){t.$store.dispatch("login",e),t.$router.push({path:"/"}),t.$message.success("注册成功!")}).catch(function(e){console.log(e),t.$message.error(e.message)})})}}},v={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("h1",[e._v("注册")]),e._v(" "),r("div",{staticClass:"from-panel"},[r("el-form",{ref:"form",attrs:{"label-position":"top","label-width":"80px",rules:e.rules,model:e.user}},[r("el-form-item",{attrs:{label:"用户名",prop:"name"}},[r("el-input",{model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"邮件",prop:"email"}},[r("el-input",{model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"pwd"}},[r("el-input",{attrs:{type:"password"},model:{value:e.user.pwd,callback:function(t){e.$set(e.user,"pwd",t)},expression:"user.pwd"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"确认密码",prop:"cpwd"}},[r("el-input",{attrs:{type:"password"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("form")}},model:{value:e.user.cpwd,callback:function(t){e.$set(e.user,"cpwd",t)},expression:"user.cpwd"}})],1),e._v(" "),r("div",{staticClass:"oprator"},[r("el-button",{staticClass:"submit",attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("提交")])],1)],1)],1)])},staticRenderFns:[]};var p=r("VU/8")(h,v,!1,function(e){r("qFjU")},"data-v-2a21ef49",null).exports,_={name:"signIn",data:function(){return{labelPosition:"top",user:{name:"",pwd:""},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:7,message:"长度在 3 到 7 个字符之间",trigger:"blur"}],pwd:[{required:!0,message:"必须填写",trigger:"blur"}]}}},mounted:function(){this.$Progress.finish()},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message.error("错了哦，您填写的信息有错误，请按照提示修改。"),!1;t.$api.SDK.User.logIn(t.user.name,t.user.pwd).then(function(e){t.$store.dispatch("login",e),t.$router.replace("/article?type=all"),t.$message.success("登陆成功！")}).catch(function(e){t.$message.error(e.message)})})},test:function(){console.log("enter-------------------------------------------")}}},b={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("h1",[e._v("登录")]),e._v(" "),r("div",{staticClass:"from-panel"},[r("el-form",{ref:"form",attrs:{"label-position":"top","label-width":"80px",rules:e.rules,model:e.user}},[r("el-form-item",{attrs:{label:"用户名",prop:"name"}},[r("el-input",{model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"pwd"}},[r("el-input",{attrs:{type:"password"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("form")}},model:{value:e.user.pwd,callback:function(t){e.$set(e.user,"pwd",t)},expression:"user.pwd"}})],1),e._v(" "),r("div",{staticClass:"oprator"},[r("el-button",{staticClass:"submit",attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("登录")])],1)],1)],1)])},staticRenderFns:[]};var y=r("VU/8")(_,b,!1,function(e){r("u59C")},"data-v-477575d5",null).exports,w=null,C={name:"create",data:function(){return{categorys:[],form:{category:null,title:""},rules:{title:[{required:!0,message:"必须填写标题哦!",trigger:"blur"}],category:[{type:"object",required:!0,message:"必须填写分类哦!",trigger:"blur"}]},validate:{error:!1}}},created:function(){this.getCategory()},mounted:function(){this.initEditor(),this.$Progress.finish()},computed:Object(o.d)(["user"]),methods:{content:function(){return w.$txt.html()},initEditor:function(){var e=this,t=window.wangEditor;(w=new t("editor")).config.menus=$.map(wangEditor.config.menus,function(e,t){return"location"===e?null:e}),w.create(),w.onchange=function(){e.validateContent()}},getCategory:function(){var e=this;new this.$api.SDK.Query("Category").find().then(function(t){e.categorys=t,e.form.category=t[0]}).catch(console.error)},validateContent:function(){if("<p><br></p>"==this.content())return this.validate.error=!0,void $(".wangEditor-container").css({borderColor:"red"});this.validate.error=!1,$(".wangEditor-container").css({borderColor:"#ccc"})},createArticle:function(){var e=new this.$api.SDK.Object("Article");return e.set("author",this.user),e.set("title",this.form.title),e.set("content",this.content()),e.set("category",this.form.category),e},setACL:function(e){var t=new this.$api.SDK.ACL;t.setPublicReadAccess(!0),t.setWriteAccess(this.user,!0),e.setACL(t)},save:function(e){var t=this;e.save().then(function(e){console.log(e);var r="文章《"+e.get("title")+"》发布成功",s=new t.$api.SDK.Status;s.inboxType="friend",s.set("title",e.get("title")),s.set("type","create_article"),s.set("article",e),t.$api.SDK.Status.sendStatusToFollowers(s).then(function(e){console.dir(e)},function(e){console.dir(e)}),t.$message({message:r,type:"success"}),t.$router.replace({name:"ArticleShow",params:{id:e.id}})}).catch(console.error)},submit:function(){var e=this;this.$refs.form.validate(function(t){if(e.validateContent(),!t)return console.log("error submit!!"),e.$message.error("错了哦，您填写的信息有错误，请按照提示修改。"),!1;var r=e.createArticle();e.setACL(r),e.save(r)})}}},x={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("h3",{staticClass:"title is-3"},[e._v("发布一篇新的文章")]),e._v(" "),r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","label-position":"top"}},[r("el-form-item",{attrs:{label:"文章分类",prop:"category"}},[r("el-select",{attrs:{placeholder:"请选择文章分类"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.categorys,function(t){return r("el-option",{key:t.objectId,attrs:{label:t.get("name"),value:t}},[e._v(e._s(t.get("name")))])}))],1),e._v(" "),r("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入文章标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),r("div",{staticClass:"el-form-item is-required",class:{"is-error":e.validate.error}},[r("label",{staticClass:"el-form-item__label"},[e._v("文章内容")]),e._v(" "),r("div",{staticClass:"el-form-item__content"},[r("div",{attrs:{id:"editor"},on:{keyup:function(t){return("button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter"))&&t.ctrlKey?e.submit(t):null}}}),e._v(" "),e.validate.error?r("div",{staticClass:"el-form-item__error"},[e._v("正文怎能没有内容呢？")]):e._e()])]),e._v(" "),r("div",{staticClass:"oprator right"},[r("el-button",{staticClass:"submit",attrs:{type:"primary"},on:{click:e.submit}},[e._v("发布文章")])],1)],1)],1)},staticRenderFns:[]};var k=r("VU/8")(C,x,!1,function(e){r("zJr1")},"data-v-30a96619",null).exports,F=r("bOdI"),A={name:"List",data:function(){return{title:"",articles:[]}},created:function(){this.match()},watch:r.n(F)()({},"$route.query",function(){console.log("re render"),this.articles=[],this.match()}),computed:Object(o.d)(["user"]),methods:{match:function(){var e=this.$route.query.type||this.$route.query.cid;switch(this.$Progress.start(),e){case"me":this.getMyArticles();break;case"all":this.getAllArticles();break;default:this.getCategoryArticle(e)}},query:function(){var e=new this.$api.SDK.Query("Article");return e.include("category"),e.include("author"),e.descending("cratedAt"),e},getCategoryObj:function(e){return this.$api.SDK.Object.createWithoutData("Category",e)},setArticles:function(e){var t=this;e.find().then(function(e){t.articles=e,t.$Progress.finish()}).catch(this.fail)},fail:function(e){this.$message.error(e),this.$Progress.fail()},getAllArticles:function(){this.title="所有文章";var e=this.query();this.setArticles(e)},getMyArticles:function(){this.title="我的文章";var e=this.query();this.setArticles(e)},getCategoryArticle:function(e){var t=this.getCategoryObj(e),r=this.query();r.equalTo("category",t),this.setArticles(r)}}},E={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("header",[r("h2",[e._v(e._s(e.title))])]),e._v(" "),r("section",e._l(e.articles,function(t){return r("article",{key:t.get("id")},[r("h3",[r("router-link",{attrs:{to:{name:"ArticleShow",params:{id:t.id}}}},[e._v(e._s(t.get("title")))]),e._v(" |\n        "),r("router-link",{attrs:{to:{name:"User",params:{id:t.get("author").id}}}},[e._v(e._s(t.get("author").get("username")))])],1)])}))])},staticRenderFns:[]};var U=r("VU/8")(A,E,!1,function(e){r("5/Ai")},"data-v-793486bd",null).exports,S={name:"index",data:function(){return{article:null}},created:function(){var e=this.$route.params.id;this.getArticle(e)},computed:i()({},Object(o.c)(["uid"])),methods:{getArticle:function(e){var t=this,r=new this.$api.SDK.Query("Article");r.include("author"),r.include("category"),r.get(e).then(function(e){t.article=e,t.$Progress.finish()}).catch(console.log)},destroy:function(){var e=this;this.article.destroy().then(function(){e.$message({type:"success",message:"删除成功"}),e.$router.replace({path:"/article?type=all"})})}}},V={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[e.article?[r("h2",[e._v(e._s(e.article.get("title")))]),e._v(" "),e.uid==e.article.get("author").id?r("div",{staticClass:"oprator"},[r("router-link",{attrs:{to:{name:"ArticleEdit",params:{id:e.article.id}},tag:"button"}},[e._v("修改")]),e._v(" "),r("button",{on:{click:e.destroy}},[e._v("删除")])],1):e._e(),e._v(" "),r("div",[r("p",[e._v("Author: "+e._s(e.article.get("author").get("username")))]),e._v(" "),r("p",[e._v("Category: "+e._s(e.article.get("category").get("name")))])]),e._v(" "),r("div",{staticClass:"content",domProps:{innerHTML:e._s(e.article.get("content"))}})]:e._e()],2)},staticRenderFns:[]};var q=r("VU/8")(S,V,!1,function(e){r("VMFe")},"data-v-665a1d46",null).exports,P=r("//Fk"),D=r.n(P),K=null,j={name:"create",data:function(){return{article:null,categorys:[],form:{category:null,title:""},rules:{title:[{required:!0,message:"必须填写标题哦!",trigger:"blur"}],category:[{type:"object",required:!0,message:"必须填写分类哦!",trigger:"blur"}]},validate:{error:!1}}},created:function(){this.getCategory(),this.getArticle()},mounted:function(){this.initEditor(),window.q=this},computed:i()({},Object(o.d)(["user"]),{text:{get:function(){return K.$txt.html()},set:function(e){return K.$txt.html(e)}}}),methods:{getContent:function(){return K.$txt.html()},setContent:function(e){return K.$txt.html(e)},getArticle:function(){var e=this,t=this.$route.params.id,r=new this.$api.SDK.Query("Article");r.include("category"),r.get(t).then(function(t){e.article=t,e.form.title=t.get("title");var r=t.get("category").id;e.wait(e.categorys.length).then(function(){var t=e.categorys.findIndex(function(e){return e.id==r});e.form.category=e.categorys[t]}),e.wait(K).then(function(){e.setContent(t.get("content"))}),e.$Progress.finish()})},wait:function(e){return console.log(e),new D.a(function(t,r){var s=null;e?t():s=setInterval(function(){e&&(t(),clearInterval(s))},500)})},initEditor:function(){var e=this,t=window.wangEditor;(K=new t("editor")).config.menus=$.map(wangEditor.config.menus,function(e,t){return"location"===e?null:e}),K.create(),K.onchange=function(){e.validateContent()}},getCategory:function(){var e=this;new this.$api.SDK.Query("Category").find().then(function(t){e.categorys=t}).catch(console.error)},validateContent:function(){if("<p><br></p>"==this.getContent())return this.validate.error=!0,void $(".wangEditor-container").css({borderColor:"red"});this.validate.error=!1,$(".wangEditor-container").css({borderColor:"#ccc"})},setArticle:function(){var e=this.article;return e.set("author",this.user),e.set("title",this.form.title),e.set("content",this.getContent()),e.set("category",this.form.category),e},save:function(e){var t=this;e.save().then(function(e){console.log(e);var r="文章《"+e.get("title")+"》修改成功";t.$message({message:r,type:"success"}),t.$router.replace({name:"ArticleShow",params:{id:e.id}})}).catch(console.error)},submit:function(){var e=this;this.$refs.form.validate(function(t){if(e.validateContent(),!t)return console.log("error submit!!"),e.$message.error("错了哦，您填写的信息有错误，请按照提示修改。"),!1;var r=e.setArticle();e.save(r)})}}},L={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("h3",{staticClass:"title is-3"},[e._v("发布一篇新的文章")]),e._v(" "),r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","label-position":"top"}},[r("el-form-item",{attrs:{label:"文章分类",prop:"category"}},[r("el-select",{attrs:{placeholder:"请选择文章分类"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.categorys,function(t){return r("el-option",{key:t.id,attrs:{label:t.get("name"),value:t}},[e._v(e._s(t.get("name")))])}))],1),e._v(" "),r("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入文章标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),r("div",{staticClass:"el-form-item is-required",class:{"is-error":e.validate.error}},[r("label",{staticClass:"el-form-item__label"},[e._v("文章内容")]),e._v(" "),r("div",{staticClass:"el-form-item__content"},[r("div",{attrs:{id:"editor"}}),e._v(" "),e.validate.error?r("div",{staticClass:"el-form-item__error"},[e._v("正文怎能没有内容呢？")]):e._e()])]),e._v(" "),r("div",{staticClass:"oprator right"},[r("el-button",{staticClass:"submit",attrs:{type:"primary"},on:{click:e.submit,keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.submit(t):null}}},[e._v("发布文章")])],1)],1)],1)},staticRenderFns:[]};var R=r("VU/8")(j,L,!1,function(e){r("lsEl")},"data-v-16d95bd5",null).exports,O={name:"user",data:function(){return{current_user:null,articles:null,followed:!1,id:this.$route.params.id,dialogFormVisible:!1,form:{msg:""},rules:{msg:[{required:!0,message:"必填项",trigger:"blur"}]}}},computed:Object(o.d)(["user"]),created:function(){this.getCurrentUser()},methods:{getCurrentUser:function(){var e=this,t=this.id;new this.$api.SDK.Query("_User").get(t).then(function(t){return e.current_user=t,t}).then(function(t){e.getArticles(t),e.checkFollowed()}).catch(console.error)},getArticles:function(e){var t=this,r=new this.$api.SDK.Query("Article");r.equalTo("author",e),r.ascending("createdAt"),r.find().then(function(e){t.articles=e,t.$Progress.finish()}).catch(console.error)},toggleFollow:function(){var e=this,t=this.id;this.followed?this.user.unfollow(t).then(function(){e.followed=!1,e.$message({type:"success",message:"取消关注成功"})}).catch(console.error):this.user.follow(t).then(function(){e.followed=!0,e.$message({type:"success",message:"关注成功"})}).catch(console.error)},checkFollowed:function(){var e=this,t=this.id,r=this.user.followeeQuery();r.include("followee"),r.find().then(function(r){r.length&&r.some(function(e){return e.id==t})&&(e.followed=!0)}).catch(console.error)},sendMsg:function(){var e=this;if(this.form.msg){var t=this.$api.SDK.Status,r=new t(null,this.form.msg);r.set("from",this.user),r.set("to",this.current_user),t.sendPrivateStatus(r,this.current_user.id).then(function(t){t&&(e.dialogFormVisible=!1,e.$message({message:"发送私信成功！",type:"success"}))},function(t){e.$message.error(t)})}else this.$message.error("信息不能为空")}}},M={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.current_user?r("div",{staticClass:"container"},[r("h3",[e._v(e._s(e.current_user.get("username")))]),e._v(" "),r("hr"),e._v(" "),e.user?r("div",{staticClass:"oprator"},[e.user.id!=e.current_user.id?r("button",{on:{click:e.toggleFollow}},[e._v(e._s(e.followed?"取消关注":"关注")+"该用户")]):e._e(),e._v(" "),e.user.id!=e.current_user.id?r("button",{on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("发送私信")]):e._e()]):e._e(),e._v(" "),r("ul",e._l(e.articles,function(t){return r("li",{key:t.id},[r("router-link",{attrs:{to:{name:"ArticleShow",params:{id:t.id}}}},[e._v(e._s(t.get("title")))])],1)})),e._v(" "),r("el-dialog",{attrs:{title:"发送私信给该用户",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px","label-position":"top",rules:e.rules}},[r("el-form-item",{attrs:{label:"私信内容",prop:"msg"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.form.msg,callback:function(t){e.$set(e.form,"msg",t)},expression:"form.msg"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.sendMsg}},[e._v("确 定")])],1)],1)],1):e._e()},staticRenderFns:[]};var T=r("VU/8")(O,M,!1,function(e){r("tmcN")},"data-v-11b5ca8c",null).exports,I={name:"myFollowee",data:function(){return{followees:[]}},computed:Object(o.d)(["user"]),mounted:function(){this.getFollowee()},methods:{getFollowee:function(){var e=this,t=this.user.followeeQuery();t.include("followee"),t.find().then(function(t){e.followees=t,e.$Progress.finish()}).catch(function(t){e.$message.error(t)})}}},Q={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("h2",[e._v("我的关注")]),e._v(" "),e.followees.length?r("ul",e._l(e.followees,function(t){return r("li",{key:t.id},[r("router-link",{attrs:{to:{name:"User",params:{id:t.id}}}},[e._v(e._s(t.get("username")))])],1)})):r("span",[e._v("你没有关注任何人")])])},staticRenderFns:[]};var H=r("VU/8")(I,Q,!1,function(e){r("UTjH")},"data-v-043f2e41",null).exports,N={name:"myFollower",data:function(){return{followers:[]}},computed:Object(o.d)(["user"]),created:function(){this.getFollower()},methods:{getFollower:function(){var e=this,t=this.user.followerQuery();t.include("follower"),t.find().then(function(t){e.followers=t,e.$Progress.finish()}).catch(console.log)}}},z={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("h2",[e._v("我的粉丝")]),e._v(" "),e.followers.length?r("ul",e._l(e.followers,function(t){return r("li",{key:t.id},[r("router-link",{attrs:{to:{name:"User",params:{id:t.id}}}},[e._v(e._s(t.get("username")))])],1)})):r("span",[e._v("你没有粉丝")])])},staticRenderFns:[]};var W=r("VU/8")(N,z,!1,function(e){r("aDoV")},"data-v-76159966",null).exports,J={name:"friend",data:function(){return{statuses:{}}},created:function(){this.getFriendMsg()},methods:{getFriendMsg:function(){var e=this;this.$store.state.user.followeeQuery().find().then(function(t){console.log(t);var r=new e.$api.SDK.Query("_Status");return r.include("source"),r.include("article"),r.equalTo("inboxType","friend"),r.containedIn("source",t),r.find()}).then(function(t){e.statuses=t,e.$Progress.finish(),console.dir(t)},function(e){console.dir(e)})}}},Y={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[e.statuses.length?r("ul",e._l(e.statuses,function(t){return r("li",{key:t.get("source").id},[r("router-link",{attrs:{to:{name:"User",params:{id:t.get("source").id}}}},[e._v(e._s(t.get("source").get("username")))]),e._v(" 在 "+e._s(t.createdAt)+"\n      "),"create_article"==t.get("type")?r("span",[e._v("\n        创建了新的文章 "),r("router-link",{attrs:{to:{name:"ArticleShow",params:{id:t.get("article").id}}}},[e._v(e._s(t.get("article").get("title")))])],1):e._e()],1)})):e._e()])},staticRenderFns:[]};var X=r("VU/8")(J,Y,!1,function(e){r("rEfE")},"data-v-fdfa9cea",null).exports,G={name:"myMessage",data:function(){return{messages:[],sendTo:null,dialogFormVisible:!1,form:{msg:""},rules:{msg:[{required:!0,message:"必填项",trigger:"blur"}]}}},created:function(){this.getMessages()},methods:{getMessages:function(){var e=this,t=new this.$api.SDK.Query("_Status");t.include("from"),t.equalTo("to",this.$store.state.user),t.equalTo("inboxType","private"),t.find().then(function(t){console.log(t),e.messages=t,e.$Progress.finish()}).catch(function(t){e.$messages.error(t)})},send:function(e){this.sendTo=e,this.dialogFormVisible=!0},sendMsg:function(){var e=this;if(this.form.msg){var t=this.$api.SDK.Status,r=new t(null,this.form.msg),s=this.$store.state.user;r.set("from",s),r.set("to",this.sendTo),t.sendPrivateStatus(r,s.id).then(function(t){t&&(e.dialogFormVisible=!1,e.$message({message:"发送私信成功！",type:"success"}),console.log(t))},function(t){e.$message.error(t)})}else this.$message.error("信息不能为空")},destroy:function(e){var t=this;console.log(e),this.messages[e].destroy().then(function(r){r&&(t.messages.splice(e,1),t.$messages({messages:"删除成功",type:"success"}))})}}},B={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("h2",[e._v("我的消息")]),e._v(" "),e.messages.length?r("ul",e._l(e.messages,function(t,s){return r("li",{key:t.get("from").id},[r("router-link",{attrs:{to:{name:"User",params:{id:t.get("from").id}}}},[e._v(e._s(t.get("from").get("username")))]),e._v(" 给你发了一条信息\n      "),r("p",[r("button",{on:{click:function(t){e.destroy(s)}}},[e._v("删除")]),e._v(" "),r("button",{on:{click:function(r){e.send(t.get("from"))}}},[e._v("回复")])]),e._v(" "),r("p",[e._v(e._s(t.get("message")))])],1)})):r("span",[e._v("没有消息")]),e._v(" "),r("el-dialog",{attrs:{title:"发送私信给该用户",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px","label-position":"top",rules:e.rules}},[r("el-form-item",{attrs:{label:"私信内容",prop:"msg"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.form.msg,callback:function(t){e.$set(e.form,"msg",t)},expression:"form.msg"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sendMsg()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var Z=r("VU/8")(G,B,!1,function(e){r("Vl06")},"data-v-e8631e98",null).exports;s.default.use(m.a);var ee=new m.a({routes:[{path:"/",name:"HelloWorld",component:g},{path:"/article",name:"ArticleList",component:U},{path:"/signUp",name:"signUp",component:p},{path:"/signIn",name:"signIn",component:y},{path:"/ArticleCreate",name:"ArticleCreate",component:k,meat:{needLogin:!0}},{path:"/article/:id",name:"ArticleShow",component:q},{path:"/article/:id/edit",name:"ArticleEdit",component:R,meta:{needLogin:!0}},{path:"/user/:id",name:"User",component:T},{path:"/followee",name:"Followee",component:H,meta:{needLogin:!0}},{path:"/follower",name:"Follower",component:W,meta:{needLogin:!0}},{path:"/friend",name:"Friend",component:X},{path:"/message",name:"MyMessage",component:Z,meta:{needLogin:!0}}]});s.default.use(o.a);var te=new o.a.Store({state:{user:null},mutations:{setUser:function(e,t){e.user=t}},getters:{uid:function(e){var t=e.user;return t?t.id:null}},actions:{exit:function(e){e.commit("setUser",null)},login:function(e,t){e.commit("setUser",t)}}}),re=r("JnRc"),se=r.n(re);se.a.init({appId:"UvLoREvvFpxBNxtNuYCPjWbs-gzGzoHsz",appKey:"5GaICyANtnLXd6wUsy9n2LHW"});var ne={SDK:se.a},ie=r("zL8q"),oe=r.n(ie),ae=(r("tvR6"),r("8sJK"),r("zYko")),le=r.n(ae);ee.beforeEach(function(e,t,r){e.matched.some(function(e){return e.meta.needLogin})?te.state.user?r():(ue.$message.error("请先登录!"),r({path:"/signIn"})):r()}),s.default.use(oe.a);s.default.use(le.a,{color:"#159957",failedColor:"#874b4b",thickness:"2px",transition:{speed:"0.2s",opacity:"0.6s",termination:300},autoRevert:!0,location:"top",inverse:!1}),s.default.config.productionTip=!1,localStorage.setItem("debug","leancloud*");var ce=ne.SDK.User.current();ce&&(console.log(ce),te.commit("setUser",ce)),s.default.mixin({beforeCreate:function(){this.$api||(this.$api=ne)}});var ue=new s.default({el:"#app",router:ee,store:te,render:function(e){return e(d)}})},UTjH:function(e,t){},VMFe:function(e,t){},Vl06:function(e,t){},aDoV:function(e,t){},dpXV:function(e,t){},lsEl:function(e,t){},oNCY:function(e,t){},qFjU:function(e,t){},rEfE:function(e,t){},tmcN:function(e,t){},tvR6:function(e,t){},u59C:function(e,t){},zJr1:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.b2f223963d6f916c3dc7.js.map